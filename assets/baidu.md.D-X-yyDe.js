import{_ as t,c as e,o as d,a4 as a}from"./chunks/framework.JW47PfsW.js";const g=JSON.parse('{"title":"大华视频接入","description":"","frontmatter":{},"headers":[],"relativePath":"baidu.md","filePath":"baidu.md"}'),r={name:"baidu.md"},i=a('<h1 id="大华视频接入" tabindex="-1">大华视频接入 <a class="header-anchor" href="#大华视频接入" aria-label="Permalink to &quot;大华视频接入&quot;">​</a></h1><h2 id="——准备" tabindex="-1">|——准备 <a class="header-anchor" href="#——准备" aria-label="Permalink to &quot;|——准备&quot;">​</a></h2><h3 id="——准备icc环境" tabindex="-1">|——准备ICC环境 <a class="header-anchor" href="#——准备icc环境" aria-label="Permalink to &quot;|——准备ICC环境&quot;">​</a></h3><ul><li>ICC环境一般是部署在现场客户服务器上，由区域同事安装部署</li><li>ICC平台地址是<a href="https://xn--ip-4k6cr21b" target="_blank" rel="noreferrer">https://平台ip</a>:端口默认443，用户密码由区域同事提供，访问凭证可由区域同事/客户（知晓超级管理员用户/密码的人员）申请</li></ul><p>平台部署完之后：</p><ul><li><p>登录管理平台</p></li><li><p>获取密钥：使用<code>system</code>用户登录，登录后获取申请访问凭证，即获取<code>clientId、clienSecret</code></p></li><li><p>进入管理平台后申请OpenAPI</p></li></ul><p><img src="https://qvqzhm.oss-cn-guangzhou.aliyuncs.com/img/image-20230519091826207.png" alt="image-20230519091826207"></p><ul><li>申请访问凭证</li></ul><p><img src="https://qvqzhm.oss-cn-guangzhou.aliyuncs.com/img/image-20230519091845002.png" alt="image-20230519091845002"></p><ul><li>填写凭证</li></ul><p><img src="https://qvqzhm.oss-cn-guangzhou.aliyuncs.com/img/image-20230519091934319.png" alt="image-20230519091934319"></p><h3 id="——申请openapi用户" tabindex="-1">|——申请openAPI用户 <a class="header-anchor" href="#——申请openapi用户" aria-label="Permalink to &quot;|——申请openAPI用户&quot;">​</a></h3><h4 id="——创建角色-已有可跳过" tabindex="-1">|——创建角色（已有可跳过） <a class="header-anchor" href="#——创建角色-已有可跳过" aria-label="Permalink to &quot;|——创建角色（已有可跳过）&quot;">​</a></h4><p><img src="https://qvqzhm.oss-cn-guangzhou.aliyuncs.com/img/image-20230519092158257.png" alt="image-20230519092158257"></p><ul><li>添加角色</li></ul><p><img src="https://qvqzhm.oss-cn-guangzhou.aliyuncs.com/img/image-20230519092243551.png" alt="image-20230519092243551"></p><p><img src="https://qvqzhm.oss-cn-guangzhou.aliyuncs.com/img/image-20230519092253546.png" alt="image-20230519092253546"></p><h4 id="——创建用户" tabindex="-1">|——创建用户 <a class="header-anchor" href="#——创建用户" aria-label="Permalink to &quot;|——创建用户&quot;">​</a></h4><p><img src="https://qvqzhm.oss-cn-guangzhou.aliyuncs.com/img/image-20230519092318337.png" alt="image-20230519092318337"></p><p><img src="https://qvqzhm.oss-cn-guangzhou.aliyuncs.com/img/image-20230519092332425.png" alt="image-20230519092332425"></p><p><img src="https://qvqzhm.oss-cn-guangzhou.aliyuncs.com/img/image-20230519092344300.png" alt="image-20230519092344300"></p><h2 id="——接入方式" tabindex="-1">|——接入方式 <a class="header-anchor" href="#——接入方式" aria-label="Permalink to &quot;|——接入方式&quot;">​</a></h2><ul><li>使用大华播放控件（固定控件）</li><li>取流播放：flv流或hls流</li></ul><h2 id="——鉴权" tabindex="-1">|——鉴权 <a class="header-anchor" href="#——鉴权" aria-label="Permalink to &quot;|——鉴权&quot;">​</a></h2><ul><li>文档参考：<a href="https://open-icc.dahuatech.com/#/home" target="_blank" rel="noreferrer">https://open-icc.dahuatech.com/#/home</a> 对接指南——鉴权介绍</li><li><code>account_token</code>是通过消费用户的<code>clientId、clienSecret</code>获取的，时效为2h</li></ul><h2 id="——接入" tabindex="-1">|——接入 <a class="header-anchor" href="#——接入" aria-label="Permalink to &quot;|——接入&quot;">​</a></h2><h3 id="——环境" tabindex="-1">|——环境 <a class="header-anchor" href="#——环境" aria-label="Permalink to &quot;|——环境&quot;">​</a></h3><ul><li><p>文档参考：<a href="https://open-icc.dahuatech.com/#/home" target="_blank" rel="noreferrer">https://open-icc.dahuatech.com/#/home</a> 对接指南——快速开始</p></li><li><p>ICC Java SDK</p></li></ul><h3 id="——设备数据获取" tabindex="-1">|——设备数据获取 <a class="header-anchor" href="#——设备数据获取" aria-label="Permalink to &quot;|——设备数据获取&quot;">​</a></h3><ul><li>参考文档:<a href="https://open-icc.dahuatech.com/#/home" target="_blank" rel="noreferrer">https://open-icc.dahuatech.com/#/home</a> API文档——基础资源——设备管理</li><li>相关设备信息可以通过平台直接获取</li></ul><p><img src="https://qvqzhm.oss-cn-guangzhou.aliyuncs.com/img/image-20230519095025598.png" alt="image-20230519095025598"></p><p><img src="https://qvqzhm.oss-cn-guangzhou.aliyuncs.com/img/image-20230519095036520.png" alt="image-20230519095036520"></p><h3 id="——取流预览接入" tabindex="-1">|——取流预览接入 <a class="header-anchor" href="#——取流预览接入" aria-label="Permalink to &quot;|——取流预览接入&quot;">​</a></h3><ul><li>API：/evo-apigw/admin/API/video/stream/realtime POST</li></ul><table><thead><tr><th>参数名</th><th>必选</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td><strong>data</strong></td><td>true</td><td>string</td><td>Json串</td></tr><tr><td>channelId</td><td>true</td><td>string</td><td>视频通道编码</td></tr><tr><td>streamType</td><td>true</td><td>string</td><td>码流类型：1=主码流, 2=辅码流，3=辅码流2</td></tr><tr><td>type</td><td>true</td><td>string</td><td>hls,hlss,flv,flvs,rtmp</td></tr></tbody></table><h3 id="——取流回放-flv不支持" tabindex="-1">|——取流回放（flv不支持） <a class="header-anchor" href="#——取流回放-flv不支持" aria-label="Permalink to &quot;|——取流回放（flv不支持）&quot;">​</a></h3><ul><li>API：/evo-apigw/admin/API/video/stream/record POST</li></ul><table><thead><tr><th>参数名</th><th>必选</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td><strong>data</strong></td><td>true</td><td>Object</td><td>Json对象</td></tr><tr><td>- channelId</td><td>true</td><td>string</td><td>视频通道编码，第一个$后数字代表<a href="https://open-icc.dahuatech.com/iccdoc/enterprisebase/5.0.12/wiki/common/enum_list.html#%E5%8D%95%E5%85%83%E7%B1%BB%E5%9E%8B" target="_blank" rel="noreferrer">通道类型</a>，必须是1</td></tr><tr><td>- streamType</td><td>true</td><td>string</td><td>码流类型：1=主码流, 2=辅码流，3=辅码流2</td></tr><tr><td>- type</td><td>true</td><td>string</td><td>支持hls/hlss/rtmp格式， flv录像类型不支持</td></tr><tr><td>- recordType</td><td>true</td><td>string</td><td>录像类型：1 表示普通录像</td></tr><tr><td>- beginTime</td><td>true</td><td>string</td><td>开始时间,格式:yyyy-MM-dd HH:mm:ss</td></tr><tr><td>- endTime</td><td>true</td><td>string</td><td>结束时间,格式:yyyy-MM-dd HH:mm:ss</td></tr><tr><td>- recordSource</td><td>true</td><td>string</td><td>录像来源：2：设备 device,3：中心 center</td></tr></tbody></table><h3 id="——控件接入" tabindex="-1">|——控件接入 <a class="header-anchor" href="#——控件接入" aria-label="Permalink to &quot;|——控件接入&quot;">​</a></h3><h4 id="——所需参数" tabindex="-1">|——所需参数 <a class="header-anchor" href="#——所需参数" aria-label="Permalink to &quot;|——所需参数&quot;">​</a></h4><ul><li>设备通道编号：channelId</li><li>account_token</li><li>控件接入的方式与海康相似</li></ul><p>效果：</p><h2 id="——另" tabindex="-1">|——另 <a class="header-anchor" href="#——另" aria-label="Permalink to &quot;|——另&quot;">​</a></h2><ul><li>大华平台能够添加海康设备</li><li>大华视频PC端没有提供<code>iframe</code>嵌入的接入方式</li><li>大华设备添加后需要在自己的平台中接入的话，需要拿着ICC平台注册好的设备信息再到自己的平台中录入好对应的信息（同海康）</li></ul><h2 id="——总结" tabindex="-1">|——总结 <a class="header-anchor" href="#——总结" aria-label="Permalink to &quot;|——总结&quot;">​</a></h2><ol><li>目前我们没有自己的ICC平台账号以及域名，需要联系相关人员部署。</li><li>部署好自己的平台后，平台的使用方式与云眸相似。</li><li>体验网址：<a href="https://124.160.33.135:4077/#/home" target="_blank" rel="noreferrer">https://124.160.33.135:4077/#/home</a> 账号：TEST 密码：Admin123</li><li>平台相关问题文档：<a href="https://open-icc.dahuatech.com/faq/icc/index.html#/icc/00/platform" target="_blank" rel="noreferrer">https://open-icc.dahuatech.com/faq/icc/index.html#/icc/00/platform</a></li></ol><h2 id="——接入流程-开发" tabindex="-1">|——接入流程（开发） <a class="header-anchor" href="#——接入流程-开发" aria-label="Permalink to &quot;|——接入流程（开发）&quot;">​</a></h2><h3 id="——鉴权-1" tabindex="-1">|——鉴权 <a class="header-anchor" href="#——鉴权-1" aria-label="Permalink to &quot;|——鉴权&quot;">​</a></h3><ul><li><p>获取公钥：/evo-apigw/evo-oauth/1.0.0/oauth/public-key GET</p></li><li><p>认证：/evo-apigw/evo-oauth/1.0.0/oauth/extend/token POST</p><ul><li>参数：</li></ul><table><thead><tr><th>参数名</th><th>必选</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>grant_type</td><td>是</td><td>string(0,128)</td><td>授权类型，固定值：password</td></tr><tr><td>username</td><td>是</td><td>string(0,50)</td><td>用户名</td></tr><tr><td>password</td><td>是</td><td>string(0,255)</td><td>平台密码，需RSA加密密码传输,RSA公钥<a href="https://open-icc.dahuatech.com/iccdoc/enterprisebase/5.0.12/wiki/evo-oauth/userPass.html#%E8%8E%B7%E5%8F%96%E5%85%AC%E9%92%A5" target="_blank" rel="noreferrer">获取公钥</a>接口，加密参考：<a href="https://open-icc.dahuatech.com/download/others/RSA%E5%AF%86%E7%A0%81%E5%8A%A0%E5%AF%86.zip" target="_blank" rel="noreferrer">RSA加密demo</a></td></tr><tr><td>client_id</td><td>是</td><td>string(0,128)</td><td>凭证id，自定义，建议数字、字母</td></tr><tr><td>client_secret</td><td>是</td><td>string(0,128)</td><td>凭证密钥，<strong>访问凭证client_id与client_secret必须一致</strong>，详见<a href="https://open-icc.dahuatech.com/iccdoc/enterprisebase/5.0.12/wiki/common/summary.html#%E7%94%B3%E8%AF%B7%E8%AE%BF%E9%97%AE%E5%87%AD%E8%AF%81" target="_blank" rel="noreferrer">申请访问凭证</a>获取</td></tr><tr><td>public_key</td><td>是</td><td>string(0,512)</td><td>公钥，由鉴权中心下发</td></tr><tr><td>code</td><td>否</td><td>string(0,8)</td><td>动态验证码</td></tr><tr><td>verifyCodeFlag</td><td>否</td><td>int(1)</td><td>是否启用动态验证码功能 0：关闭 1：开启 默认0；5.0.9+支持；若想开启动态验证码功能，在保证[系统配置-&gt;账号安全设置-&gt;登录验证码]开关开启的前提下，接口参数需传1，否则开启不生效</td></tr></tbody></table></li><li><p>刷新认证：/evo-apigw/evo-oauth/1.0.0/oauth/extend/refresh/token POST</p><ul><li><table><thead><tr><th>参数名</th><th>必选</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>grant_type</td><td>true</td><td>string(0,128)</td><td>认证类型，固定值：refresh_token</td></tr><tr><td>client_id</td><td>true</td><td>string(0,128)</td><td>客户端id，自定义，支持数字、字母，即<a href="https://open-icc.dahuatech.com/iccdoc/enterprisebase/5.0.12/wiki/evo-oauth/userPass.html#%E8%AE%A4%E8%AF%81" target="_blank" rel="noreferrer">认证</a>接口中的client_id与client_secret</td></tr><tr><td>client_secret</td><td>true</td><td>string(0,128)</td><td>客户端secret，，详见<a href="https://open-icc.dahuatech.com/iccdoc/enterprisebase/5.0.12/wiki/common/summary.html#%E7%94%B3%E8%AF%B7%E8%AE%BF%E9%97%AE%E5%87%AD%E8%AF%81" target="_blank" rel="noreferrer">申请访问凭证</a>获取</td></tr><tr><td>refresh_token</td><td>true</td><td>string(0,2048)</td><td>refresh_token</td></tr></tbody></table></li><li><p><strong>返回参数</strong></p><table><thead><tr><th>名称</th><th>类型</th><th>说明</th><th>版本号</th></tr></thead><tbody><tr><td>success</td><td>boolean</td><td>接口返回是否成功</td><td></td></tr><tr><td>code</td><td>string</td><td>错误码：0为无错误，非0为具体错误码</td><td></td></tr><tr><td>errMsg</td><td>string</td><td>错误消息</td><td></td></tr><tr><td>data</td><td>object</td><td>返回数据对象</td><td></td></tr><tr><td>+ id</td><td>string</td><td>被修改的用户id</td><td></td></tr><tr><td>+ access_token</td><td>string</td><td>鉴权token</td><td>请求业务接口时设置请求头字段Authorization=<strong>token_type</strong> + 空格 + <strong>access_token</strong></td></tr><tr><td>+ refresh_token</td><td>string</td><td>刷新token</td><td>刷新token，有效期1天;一般需要结合<a href="https://open-icc.dahuatech.com/iccdoc/enterprisebase/5.0.12/wiki/evo-oauth/userPass.html#%E5%88%B7%E6%96%B0%E8%AE%A4%E8%AF%81%E4%BF%A1%E6%81%AF" target="_blank" rel="noreferrer">刷新认证信息接</a>口获取access_token,避免再次输入密码获取</td></tr><tr><td>+ token_type</td><td>string</td><td>令牌类型，固定bearer</td><td></td></tr><tr><td>+ expires_in</td><td>long</td><td>access_token有效期,单位是秒</td><td></td></tr><tr><td>+ scope</td><td>string</td><td>作用域，固定‘*’</td><td></td></tr><tr><td>+ userId</td><td>string</td><td>用户id</td><td></td></tr></tbody></table></li></ul></li></ul><h3 id="——获取设备详情" tabindex="-1">|——获取设备详情 <a class="header-anchor" href="#——获取设备详情" aria-label="Permalink to &quot;|——获取设备详情&quot;">​</a></h3><ul><li>/evo-apigw/evo-brm/1.0.0/device/{deviceCode} GET（设备编码ICC平台获取）</li><li>获取设备通道信息：/evo-apigw/evo-brm/1.2.0/device/subsystem/page POST</li></ul>',51),o=[i];function l(h,n,c,s,u,m){return d(),e("div",null,o)}const b=t(r,[["render",l]]);export{g as __pageData,b as default};
